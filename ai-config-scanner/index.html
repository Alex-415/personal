<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Assisted Cloud Config Risk Scanner</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; line-height: 1.6; color: #171717; }
        .container { min-height: 100vh; padding: 2rem; max-width: 900px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 2rem; }
        .header h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        .header p { color: #666; }
        .main { display: flex; flex-direction: column; gap: 1rem; }
        .textarea { width: 100%; padding: 1rem; border: 1px solid #ddd; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 14px; resize: vertical; }
        .button { padding: 0.75rem 2rem; background: #000; color: white; border: none; border-radius: 8px; font-size: 1rem; cursor: pointer; }
        .button:hover { background: #333; }
        .button:disabled { background: #999; cursor: not-allowed; }
        .error { padding: 1rem; background: #fee; border: 1px solid #fcc; border-radius: 8px; color: #c00; }
        .results { margin-top: 2rem; display: flex; flex-direction: column; gap: 2rem; }
        .section { padding: 1.5rem; background: #f9f9f9; border-radius: 8px; }
        .section h2 { font-size: 1.25rem; margin-bottom: 1rem; }
        .riskList { list-style: none; padding: 0; }
        .riskList li { padding: 0.75rem; margin-bottom: 0.5rem; border-radius: 6px; border-left: 4px solid; }
        .high { background: #fee; border-color: #c00; }
        .medium { background: #ffeaa7; border-color: #fdcb6e; }
        .low { background: #e3f2fd; border-color: #2196f3; }
        .severity { font-weight: bold; text-transform: uppercase; font-size: 0.75rem; margin-right: 0.5rem; }
        .footer { margin-top: 3rem; padding: 1.5rem; background: #fff3cd; border: 1px solid #ffc107; border-radius: 8px; text-align: center; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>AI-Assisted Cloud Config Risk Scanner</h1>
            <p>Paste AWS configuration text for AI-assisted review</p>
        </header>

        <main class="main">
            <textarea id="configInput" class="textarea" placeholder="Paste AWS config here (IAM policy JSON, S3 config, Terraform, CloudFormation)..." rows="12"></textarea>
            <button class="button" onclick="analyzeConfig()">Analyze</button>
            <div id="error" class="error hidden"></div>
            <div id="results" class="results hidden"></div>
        </main>

        <footer class="footer">
            <p>⚠️ This is an AI-assisted review for educational purposes. It does not guarantee security, compliance, or correctness.</p>
        </footer>
    </div>

    <script>
        function analyzeConfig() {
            const config = document.getElementById('configInput').value;
            const errorDiv = document.getElementById('error');
            const resultsDiv = document.getElementById('results');

            errorDiv.classList.add('hidden');
            resultsDiv.classList.add('hidden');

            if (!config.trim()) {
                errorDiv.textContent = 'Please paste a configuration to analyze';
                errorDiv.classList.remove('hidden');
                return;
            }

            // Mock analysis (replace with actual API call in production)
            const analysis = analyzeMock(config);
            displayResults(analysis);
        }

        function analyzeMock(config) {
            const risks = [];
            const suggestions = [];
            let summary = 'This configuration ';

            // Check for wildcard permissions
            if ((config.includes('"*"') || config.includes("'*'")) && 
                config.toLowerCase().includes('action') && 
                config.toLowerCase().includes('resource')) {
                risks.push({
                    severity: 'high',
                    description: 'Wildcard (*) permissions detected on both Action and Resource. This grants unrestricted access and is commonly discouraged.'
                });
                suggestions.push('Replace wildcard permissions with specific, least-privilege actions and resources');
                summary += 'grants broad wildcard permissions, ';
            }

            // Check for public access
            if (config.toLowerCase().includes('public') || config.includes('0.0.0.0/0')) {
                risks.push({
                    severity: 'medium',
                    description: 'Public access or open CIDR range (0.0.0.0/0) detected. This may expose resources publicly.'
                });
                suggestions.push('Restrict access to specific IP ranges or private networks');
                summary += 'may allow public access, ';
            }

            // Check for hardcoded secrets
            if (/secret|password|key|token/i.test(config) && /[A-Za-z0-9+/=]{20,}/.test(config)) {
                risks.push({
                    severity: 'high',
                    description: 'Possible hardcoded secret or credential detected. Hardcoded secrets are a security risk.'
                });
                suggestions.push('Use AWS Secrets Manager or environment variables instead of hardcoded credentials');
            }

            if (risks.length === 0) {
                summary = 'This configuration appears to follow common security practices. No obvious risks detected.';
            } else {
                summary = summary.slice(0, -2) + '. Review recommended.';
            }

            return { summary, risks, suggestions };
        }

        function displayResults(analysis) {
            const resultsDiv = document.getElementById('results');
            
            let html = `
                <div class="section">
                    <h2>Summary</h2>
                    <p>${analysis.summary}</p>
                </div>
                <div class="section">
                    <h2>Potential Risks</h2>
            `;

            if (analysis.risks.length === 0) {
                html += '<p>No obvious risks detected.</p>';
            } else {
                html += '<ul class="riskList">';
                analysis.risks.forEach(risk => {
                    html += `<li class="${risk.severity}"><span class="severity">${risk.severity}</span>${risk.description}</li>`;
                });
                html += '</ul>';
            }

            html += '</div><div class="section"><h2>Suggested Improvements</h2>';

            if (analysis.suggestions.length === 0) {
                html += '<p>No specific suggestions at this time.</p>';
            } else {
                html += '<ul>';
                analysis.suggestions.forEach(suggestion => {
                    html += `<li>${suggestion}</li>`;
                });
                html += '</ul>';
            }

            html += '</div>';
            resultsDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }
    </script>
</body>
</html>
